## 文件说明

- 99.txt为门人推荐书任务
- 999.txt及以前为自定义任务
- 1100~1500.txt为不灭戒指任务
- 9998~9999.txt为神功升级任务

```pascal
// 以下二者等效
Name := callfunc ('getquestitem 1~7');
// 0~1 为event目录中的物品
Str := callfunc ('getrandomitem 2~8');
```

```
   QUEST_NONE           = 0;   // 无任务
   QUEST_BEGINNERPRIZE  = 1;   // 新手奖励
   QUEST_PRIZE1         = 2;   // 普通奖励 1阶
   QUEST_PRIZE2         = 3;   // 普通奖励 2阶
   QUEST_GOLDCOIN       = 4;   // 金币奖励
   QUEST_PICKAX         = 5;   // 十字镐奖励
   QUEST_ATTRIBUTEPIECE = 6;   // 属性碎片奖励
   QUEST_WEAPON         = 7;   // 武器奖励
```

1. QuestItem_1stBeginnerPrize.sdb：天桃兑换|云桥挑战|初级宝箱|礼盒
2. QuestItem_1stPrize.sdb：长城以南任务奖励（有招式全集和四大神功全集才触发）|礼盒
3. QuestItem_2ndPrize.sdb：百宝箱触发奖励|中级宝箱|礼盒|比武老人兑换
4. QuestItem_GoldCoin.sdb：长城以南任务奖励|天桃兑换（金元）
5. QuestItem_PickAx.sdb：长城以南铁匠任务奖励（十字镐）
6. QuestItem_AttributePiece.sdb：长城以南任务奖励（八卦牌，无境界任务兑换几率最高）
7. QuestItem_Weapon.sdb：长城以南任务奖励（浪人武器）

## 重要函数

```pascal
   // 主线任务
   print ('changesenderfirstquest 8');
   // 当前任务
   print ('changesendercurrentquest 1250');
   // 已完成任务
   print ('changesendercompletequest 1200');
   // 任务参数
   print ('changesenderqueststr 1');

   Str := callfunc ('getsenderfirstquest');
   FirstQuest := StrToInt(Str);

   Str := callfunc ('getsenderqueststr');
   QuestStr := StrToInt(Str);

   Str := callfunc ('getsendercompletequest');
   CompleteQuest := StrToInt (Str);

   Str := callfunc ('getsendercurrentquest');
   CurrentQuest := StrToInt (Str);
```

FirstQuest为已完成的新手任务ID，CurrentQuest为当前任务ID，CompleteQuest为最近完成任务ID（任务ID最大值2099999999，超过重置为0），QuestStr为当前任务参数文本。

任务相关物品Kind:ITEM_KIND_QUESTITEM、ITEM_KIND_QUESTITEM2、ITEM_KIND_QUESTLOG、ITEM_KIND_CHARM和GRADEUPQUESTITEM，前4种可由deletequestitem删除，后1种可由gethavegradequestitem判断。

因为只有4个位置存任务记录，所以任务系统无法支持玩家同时接多个任务。

### 主线任务（完成标记）

"first quest"（首要任务）通常指的是玩家在开始游戏时需要完成的第一个任务或目标，也可称为主线任务。这个任务通常是为了帮助玩家熟悉游戏的基本机制、控制方式和游戏世界的背景故事。

firstquest|说明
-|-
0|新注册角色初始状态
1|已登录游戏（提示欢迎新玩家）
2|通过新手村一级捕盗大将挑战
3|通过新手村一级梅花夫人挑战
4|通过新手村一级牛俊挑战
5|通过新手村一级雨中客挑战
6|通过新手村一级老侠客挑战
7|完成新手村老板娘的委托

说明：
1. firstquest必须按顺序达成，不可跳过。
2. 2~6挑战任务影响帝王石谷任务的要求，未挑战要破费，另外未达成6无法接绿林峡谷重要任务，影响黄龙峡谷道具获取。
3. 7任务完成在老板娘处合成天桃有优惠福利

### 当前任务和已完成任务

completequest和currentquest为已完成任务和当前任务记录，用来记录任务的阶段进展，也可做为支线任务记录。

重要提示：可以由Kind为37的物品调用currentquest，获取QuestSummary.sdb中对应编号的任务详情。或者由Kind为50的物品指定QuestNum获取任务详情。

quest|说明
-|-
0|无任务状态
1|无名之辈
2|小试身手
3|武功秘籍
4|天桃好运
5|初试锋芒1(熊掌:1)
6|初试锋芒2(犀牛王角:1)
7|初试锋芒3(白老虎指甲:1)
8|神龟永寿
9|江湖扬名（新手村向导任务结束）
10|爱情故事
11|萧郎任务（可跳过前面的任务，但要完成新手村挑战）
12|犀牛猎人任务（必须完成萧郎任务，可重复）
99|完成门人推鉴书任务(加入门派指定编号)
100|玉仙初始化
999|测试专用任务编号
1000|没有侠客指环重置任务
1050|帝王石谷药材商
1100|西域魔人的阴谋:万年雪参
1150|西域魔人的阴谋:东天北霸
1200|西域魔人的阴谋:侠客指环
1250|完成了西域魔人任务（没有牌王重置任务）
1300|南帝王任务:南帝王
1350|南帝王任务:寻找真相
1400|南帝王任务:寻找真相
1450|南帝王任务:邪恶降临
1500|南帝王任务:邪恶降临
1550|帝王石谷任务完成
1600|完成不灭任务
2001|黄龙峡谷系列任务(2001-2007)
9998|神功2级任务（侠客任务卷轴）
9999|神功3级任务（仙人卷轴）

说明：连续任务不可跳过，1-10，必须按顺序完成，1000-1600也必须按顺序完成。

#### QuestSummary.sdb

记录任务信息，包括以下内容：

参数|功能|说明
-|-|-
QuestNum|任务标识|对应Item.sdb和Monster.sdb文件QuestNum
QuestMainTitle|任务主标题
QuestSubTitle|任务副标题
Request|任务目的

> 任务详细内容由QuestNotice目录中QuestNum同名txt文件提供

```pascal

procedure TQuestSummaryClass.MakeQuestLogWindow (var aData : TQuestSummaryData);
var
   StrList : TStringList;
   StrList2 : TStringList;
   QuestNum : String;
   Str : String;
begin
   StrList := nil;
   StrList2 := nil;

   Str := format ('.\questnotice\%d.txt' , [aData.rQuestNumber] );
   if not FileExists (Str) then begin
      SetWordString (aData.rDesc, '');
      exit;
   end;

   try
      StrList2 := TStringList.Create;
      StrList2.LoadFromFile(Str);
      Str := StrList2.Text;
   finally
      if StrList <> nil then StrList2.Free;
   end;

   try
      QuestNum := IntToStr (aData.rQuestNumber);
      StrList := TStringList.Create;
      StrList.Add (format ('<%s>', [QuestNum] ));
      StrList.Add ('<head>');
      StrList.Add (format ('<title>%s</title>', [aData.rQuestMainTitle] ));
      StrList.Add ('<text>');
      StrList.Add (format ('%s',[aData.rQuestSubTitle] ));
      StrList.Add ('</text>');
      StrList.Add ('</head>');
      StrList.Add ('<command send=''close''>');
      StrList.Add (Conv('关闭'));
      StrList.Add ('</command>');
      StrList.Add ('<body>');
      StrList.Add (format (Conv('目的 : %s '), [aData.rRequest] ) + #13 );
      StrList.Add (Conv('详细内容:'));
      StrList.Add (Str);
      StrList.Add ('</body>');
      StrList.Add (format ('</%s>', [QuestNum] ));

      SetWordString (aData.rDesc, StrList.Text );
   finally
      if StrList <> nil then StrList.Free;
   end;
end;

```

#### 西域魔人任务

> 西域魔人篇便是玩家被阴险的西域魔人所利用，而要替他去取得东天王与北霸王的灵魂。浩然之气达到60.01以上的玩家均可以参与。

1. 先从东海沼泽的药材商处得到书函和竹筐。书函是有关任务的说明书，点击书函后确认任务的内容
2. 从北海雪原的北海雪巨人身上取到尖钩（脚趾头）
3. 将尖钩拖到天蚕上，就能得到雪参，雪参会进到竹筐里
4. 从东海沼泽的药材商处得两个葫芦瓶
5. 准备去召唤北海雪原的北霸王和东海沼泽的东天王灵魂，并将它们封存起来
6. 到阴阳师处了解得到召唤符的方法
7. 拿着小佛像到东海沼泽阴阳师处拿两张召唤符
8. 将召唤符投到香炉，北霸王/东天王就会复活，将他们的灵降住放入葫芦瓶
9. 到东海沼泽的药材商处拿到钥匙和小型竹筒
10. 用钥匙打开草屋里的抽屉，就能得到侠客指环如不拾取要重新完成任务

#### 南帝王任务

> 在受西域魔人委托去消灭南帝王的过程中，玩家意外的得知自己被恶人利用了，为了弥补过失挽回局面，便要从西域魔人处救出东天王和北霸王的灵魂，并与西域魔人进行决斗。

1. 只有已经完成西域魔人的任务，并且浩然之气为60以上时才可
2. 拿着侠客指环，到黄金沙漠的西域魔人处，领取西域牌
3. 到黄金沙漠的僧侣处了解西域魔人的过去
4. 到帝王石窟的南帝王处就能得知除掉西域魔人的方法，将把你身上的西域牌换成帝王守护灵给你
5. 到东海沼泽阴阳师处询问降魔符的制法
6. 砍断东海沼泽的千年巨木得到白桦木桩，再去找阴阳师，就能得降魔符
7. 到黄金沙漠的铁匠处咨询制石窟钥匙的制法
8. 拿到金毛狮甲(金毛狮王)和蝎子尾巴到铁匠处换石窟钥匙
9. 拿着石窟钥匙和降魔符就能进入黄金沙漠石窟了，但入场时间有限
10. 手持有降魔符，消灭东天北霸王室的所有怪物就能进入西域魔人密室了
11. 杀了西域魔人拿到戒指
12. 拿着戒指告知南帝王，西域魔人已死的讯息，得到牌王
13. 牌王属性：增加20点活力值，持久24小时。（需装备在装备栏下方倒数第二格方可发挥其属性）

#### 太极书札任务

1. 太极书札有三片，分别从东海野兽王(东海沼泽)、北海雪巨王(北海雪原)、金毛狮王(黄金沙漠)这三个高等级怪物处获得
2. 取得三片书札后去太极剑门的太极老人处，可交换到太极牌
3. 太极牌本身是一项毫无威力的物品，但如果身上携带太极类武器时，太极牌就会成为攻击力200/70/70/70和准确度30的高级附属品

### 任务文本

任务参数，用来保存任务过程中的数值的变量，如当前杀敌数量或任务状态标记，根据不同任务可随时变化。

> 提示：此参数可以存字符串变量，其它参数只能为数值，如为字符串会转为0值。

queststr|说明
-|-
0|初始状态

帝王石谷任务会用1~3标志3个阶段

----

## [千年资料站](https://act1000y.web.sdo.com/project/2017/0619zlz/index.html)

- [极乐洞](https://act1000y.web.sdo.com/project/2017/0119jldt/index.html?category=jld)
- [太极剑门](https://act1000y.web.sdo.com/project/2016/0830tjzz/index.html?category=rwwf)
- [帝王石谷](https://act1000y.web.sdo.com/project/2017/0116hjsm/index.html)
- [重返王陵](https://act1000y.web.sdo.com/project/2017/0118cfwl/index.html)
- [血皇之章](https://act1000y.web.sdo.com/project/2017/0508xhzz/index.html)

## 重返王陵

> https://act1000y.web.sdo.com/project/2017/0118cfwl/index.html

因血魔装备需要护国装备兑换，目前游戏中护国装备不全，仅有护国神剑，现补充相关设置。

### 护国系列武器

| 装备 | 材料 |
|------|------|
| 护国神拳 | 新罗龙手 + 断铠手套 + 10个金刚石 |
| 护国神剑 | 新罗宝剑 + 霸王剑 + 10个金刚石 |
| 护国神刀 | 新罗宝刀 + 天王刀 + 10个金刚石 |
| 护国神枪 | 新罗神枪 + 西域魔人枪 + 10个金刚石 |
| 护国神槌 | 新罗神槌 + 帝王槌 + 10个金刚石 |

| 装备 | 身体攻击 | 头部攻击 | 手部攻击 | 腿部攻击 | 速度 | 恢复 | 命中 | 闪躲 |
|------|----------|----------|----------|----------|------|------|------|------|
| 护国神拳 | 156 | 55 | 55 | 55 | 5 | 10 | 10 | 15 |
| 护国神剑 | 182 | 72 | 72 | 72 | 7 | 7 | - | 20 |
| 护国神刀 | 168 | 62 | 62 | 62 | 7 | 9 | 15 | 14 |
| 护国神枪 | 190 | 80 | 80 | 80 | 8 | 12 | 18 | 10 |
| 护国神槌 | 205 | 94 | 94 | 94 | 9 | 15 | 25 | 8 |

## 血皇之章

> https://act1000y.web.sdo.com/project/2011/xuehuangta/yttm.html

话说数百年前，在黄金沙漠中一场恶战可谓惊天地泣鬼神。对阵双方正是当年叱咤风云不可一世的西域魔女和享誉江湖武功盖世的三大天王。此战期间，风云变色电闪雷鸣，整整僵持了七七四十九天。最终，西域魔女以一敌三，内力不支被三大天王联手击为重伤。就在三大天王准备最后一击射杀西域魔女之时，突然血云乍现，狂沙不止，瞬间魔女消失，伴随着阵阵笑声，隐约之间听得有人说道“狂妄小辈听好，西域魔女之前和本王有约，一但性命有危险，只要本王出手相救，她便自愿归于本王魔下，成为血皇塔之血奴。现在人本王带走了，如果你们有胆量尽可前往血皇塔一战，自然本王要提醒你们，如果敢来其结果只有两个，一是死，二则是成为本王的血奴!哈哈哈哈.......”

### 黄龙峡谷

境界达到无上武念及以上的玩家角色在黄金沙漠南天王魂（黄金沙漠190，410附近）处接取任务完成提示任务后即可进入黄龙峡谷。

#### 峡谷任务

> 任务一 探听虚实：

任务NPC：传送使者（黄金沙漠368，365）

和NPC对话一探虚实，接受任务击败西域魔女。


> 任务二 武林除害：

任务NPC：火山堂主 （黄龙峡谷284，274）

完成“探听虚实”，接受任务 “击杀100个黄土巨人”，如成功杀死则完成任务。


> 任务三 初探黄龙峡谷：

任务NPC：火山堂主 （黄龙峡谷284，274）

完成“武林除害”，接受任务 “击杀100个黄土巨人”，如成功杀死则完成任务。


> 任务四 决战蛇炎鬼：

任务NPC：归天阁主 （黄龙峡谷206，280）

完成“初探黄龙峡谷”，接受任务 “击杀50个蛇炎鬼”，如成功杀死则完成任务。


> 任务五 会晤黄龙神医、血抗神丹：

任务NPC：黄龙神医（黄龙峡谷383，286）

完成“决战蛇炎鬼”任务者在NPC处接受任务“炼制神丹”

需要一定数量老虎指甲、犀牛角为材料与NPC交换神丹。

注：神丹能帮助玩家在塔内不受血魔腐气侵蚀，且神丹药效有3小时的时效。用完之后你可以再次兑换。


> 任务六 会晤灵媒、血皇塔钥匙：

任务NPC：灵媒（黄龙峡谷 340，406）

完成后在NPC处可接受任务“制作血皇塔钥匙”

制作血皇塔钥匙要是需要以“狐狸洞骨钥匙”为材料，使用1000绑定钱币+1个骨钥匙可兑换1个血皇塔钥匙。

注：进入血皇塔后需要扣除1个血皇塔钥匙。

> 任务七 每日任务：

英雄宝牌（一）

任务NPC：血皇塔老人（黄龙峡谷315，278）

完成“决战蛇炎鬼” 在NPC处可接受任务击杀一定数量血皇兵。

完成任务后获得1个英雄宝牌

千年玄金（二）

任务NPC：血皇塔老人（血皇塔第一层 76，148 ）

完成“决战蛇炎鬼” 在NPC处可接受任务消灭血炎魔

杀死一定数量血炎魔可获一定数量千年玄金(绑定)奖励。

#### 鬼魂（黄龙峡谷）系列装备

NPC：血皇塔老人（黄龙峡谷315，278）

一定数量英雄宝牌兑换鹰雕手、清月天剑、天云宝刀、白骨魔棒、天龙月斧、鬼魂令牌

| 装备 | 说明 |
|------|------|
| 鹰雕手 | 攻击速度5 恢复5 命中15 身体攻击138 手部攻击95 |
| 清月天剑 | 攻击速度5 恢复6 闪躲18 身体攻击146 头部攻击102 |
| 天云宝刀 | 攻击速度5 命中7 闪躲10 身体攻击152 脚部攻击118 |
| 白骨魔棒 | 攻击速度5 恢复8 闪躲12 身体攻击167 手部攻击133 |
| 天龙月斧 | 攻击速度5 恢复10 命中25 身体攻击181 脚部攻击157 |
| 男子/女子鬼魂盔甲 | 身体防御220 头部防御65 手部防御65 腿部防御65 恢复8 闪躲25 命中15 |
| 男子/女子鬼魂冥盔 | 身体攻击50 头部防御100 躲闪10 准确10 |
| 男子/女子鬼魂战靴 | 准确15 闪躲25 身体攻击50 腿部防御100 |
| 男子/女子鬼魂护腕 | 身体攻击50 手部防御100 躲闪15 恢复10 |
| 鬼魂令 | 速度2 恢复5 闪躲10 命中10 身体攻击100 头部攻击50 手部攻击50 腿部攻击50 |

### 血皇塔

（血皇塔90，95）处竖立有五根血魔神柱，5根柱子被击毁后即可进入。 血皇塔1-4层每隔2小时各刷新一个BOSS级怪物血魔圣女，杀死后一定几率掉落物品一定数量千年玄金、血皇石和银元。

#### 血魔王

组队中的玩家才能对血魔王进行有效攻击，如没有组队玩家则无法对其造成伤害。

血魔王生命值75%-100%时，仅使用远程武功可对其造成伤害。 血魔王生命值50%-75%时，仅使用近身武功可对其造成伤害。 血魔王生命值0-50%时，仅使用掌风武功可对其造成伤害。

每当血魔王生命值减少1/4时（即75%、50%，25%时），血魔王进入无敌状态即任何攻击对其无效。同时出现一定数量血奴怪物。当玩家杀死所有血奴怪物后，血魔王恢复正常状态（可攻击状态），直至血魔王被玩家角色杀死。 杀死血魔王后一定几率掉落物品一定数量千年玄金、一定数量金元、一定数量血魔令。

注

1. 有多个组队的情况时，伤害量第一的组队为击败血魔王的胜利者
2. 击杀血魔王后，只有同一组队队员可以拾取掉落的物品。
3. 杀死血魔王后，血皇塔5层全体玩家角色将被传送至血皇塔之外。

#### 血魔系列装备

| 装备 | 说明 |
|------|------|
| 血狂手 | 速度5 恢复10 躲闪20 准确13 身体攻击203 头部攻击72 手部攻击72 腿部攻击72 |
| 血皇剑 | 速度7 恢复7 躲闪26 身体攻击237 头部攻击94 手部攻击94 腿部攻击94 |
| 血风刀 | 速度7 恢复9 躲闪18 准确20 身体攻击218 头部攻击81 手部攻击81 腿部攻击81 |
| 血化戟 | 速度8 恢复12 躲闪13 准确23 身体攻击247 头部攻击104 手部攻击104 腿部攻击104 |
| 血皇斧 | 速度9 恢复15 躲闪10 准确33 身体攻击267 头部攻击122 手部攻击122 腿部攻击122 |
| 血皇神弓 | 速度12 躲闪15 准确30 身体攻击200 |
| 血皇龙胄 | 速度12 躲闪15 准确30 身体攻击200 |
| 男/女子血皇战甲 | 速度3 恢复10 躲闪23 准确23 维持150 身体防御455 头部防御166 手部防御166 腿部防御166 |
| 男/女子血皇头盔 | 速度1 躲闪29 准确26 身体攻击156 身体防御39 头部防御195 |
| 男/女子血皇战靴 | 速度1 恢复10 躲闪33 维持150 身体攻击156 腿部防御156 |
| 男/女子血皇护腕 | 速度1 恢复8 躲闪33 身体攻击156 手部防御195 |
| 男/女子血皇内甲 | 速度1 恢复8 躲闪10 准确23 维持120 身体攻击156 头部攻击65 手部攻击33 腿部攻击33 身体防御130 头部防御65 手部防御65 腿部防御65 |
| 男/女子血皇护腿 | 速度1 躲闪21 准确23 维持120 身体攻击156 头部攻击33 手部攻击65 腿部攻击33 身体防御130 头部防御65 手部防御65 腿部防御65 |
| 血皇之戒 | 速度3 躲闪25 准确30 活力40 特殊属性：减少死亡复活时间8秒 |
| 血皇项链 | 速度3 躲闪15 恢复5 内功35 准确25 维持250 |
| 绝霸血皇佩 | 闪躲25 身体攻击180 身体防御140 |
| 血皇令 | 速度4 恢复8 躲闪23 准确23 身体攻击455 头部攻击130 手部攻击130 腿部攻击130 身体防御260 头部防御98 手部防御98 腿部防御98 |
| 至尊血皇令 | 速度5 恢复15 躲闪30 准确30 身体攻击655 头部攻击230 手部攻击230 腿部攻击230 身体防御260 头部防御98 手部防御98 腿部防御98 |

NPC：血皇塔老人（黄龙峡谷315，278）

血魔晶兑换：300个血魔石+100个血魔令=1血魔晶

注：

1. 血魔石:杀死血魔王一定几率掉落
2. 血魔令:杀死血炎魔后一定几率掉落

| 装备 | 材料 | 结果 |
|------|------|------|
| 4级护国神拳 | 一定数量血魔晶 | 4级血狂手 |
| 4级护国神剑 | 一定数量血魔晶 | 4级血魔剑 |
| 4级护国神刀 | 一定数量血魔晶 | 4级血风刀 |
| 4级护国神枪 | 一定数量血魔晶 | 4级血化戟 |
| 4级护国神槌 | 一定数量血魔晶 | 4级血皇斧 |
| 4级男子子/女子百炼雨中客道袍 | 一定数量血魔晶 | 4级男子/女子血魔战甲 |
| 4级男子子/女子百炼雨中客斗笠 | 一定数量血魔晶 | 4级男子/女子血魔头盔 |
| 4级男子子/女子百炼雨中客战靴 | 一定数量血魔晶 | 4级男子/女子血魔战靴 |
| 4级男子子/女子百炼雨中客护腕 | 一定数量血魔晶 | 4级男子/女子血魔护腕 |

> 也可以使用0级装备兑换，需求的血魔晶为1/10
